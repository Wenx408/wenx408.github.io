(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{544:function(s,n,a){"use strict";a.r(n);var t=a(4),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",[s._v("上次总结了篇CentOS7系统安装，这次说下Redis的安装及配置开机自启动，不说废话直接上傻瓜式教程。")])]),s._v(" "),a("h2",{attrs:{id:"_1-下载redis安装包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载redis安装包"}},[s._v("#")]),s._v(" 1. 下载redis安装包")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装wget")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" –y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载redis-5.0.5.tar.gz")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.redis.io/releases/redis-5.0.5.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 若下载失败（下载成功此步跳过），可安装rz从本地上传redis-5.0.5.tar.gz")]),s._v("\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" lrzsz\nrz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"_2-安装redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装redis"}},[s._v("#")]),s._v(" 2. 安装redis")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压缩")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzf redis-5.0.5.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入目录准备安装")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-5.0.5\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装gcc，否则会编译失败/bin/sh: cc: command not found")]),s._v("\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gcc\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 读取Makefile文件进行编译（未安装gcc导致编译失败，可运行make distclean命令清除编译失败产生文件，再次运行make命令，或者直接删除redis-5.0.5目录重新安装）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装到指定目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PREFIX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/redis\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"_3-配置环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置环境变量"}},[s._v("#")]),s._v(" 3. 配置环境变量")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开配置文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/profile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在文件末尾加入下面代码，:wq保存退出(无权限可:q!强制退出，换root账户重来)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/redis\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$REDIS_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使环境变量即时生效")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"_4-配置service启动方式（可跳到第5步，配置systemctl启动方式）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置service启动方式（可跳到第5步，配置systemctl启动方式）"}},[s._v("#")]),s._v(" 4. 配置service启动方式（可跳到第5步，配置systemctl启动方式）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入redis解压目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/redis-5.0.5/utils\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行安装服务")]),s._v("\n./install_server.sh\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置端口号，默认[6379]，默认即可")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置配置文件地址，默认[/etc/redis/6379.conf]，我选择放到/usr/local/redis/etc/6379.conf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置日志文件地址，默认[/var/log/redis_6379.log]，默认即可")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置数据目录（持久化），默认[/var/lib/redis/6379]，默认即可")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置redis可执行目录，默认[/usr/local/redis/bin/redis-server]，默认即可")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后回车确认")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看redis服务状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" redis_6379 status\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动redis服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" redis_6379 start\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止redis服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" redis_6379 stop\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新启动redis服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" redis_6379 restart\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置redis开机自动启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" redis_6379 on\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置redis开机不自动启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" redis_6379 off\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"_5-另附配置systemctl启动方式（做过第4步可忽略此步）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-另附配置systemctl启动方式（做过第4步可忽略此步）"}},[s._v("#")]),s._v(" 5. 另附配置systemctl启动方式（做过第4步可忽略此步）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将redis解压目录的redis配置文件复制过来")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/redis/etc\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" redis.conf /usr/local/redis/etc/6379.conf\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改配置文件支持systemctl启动方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i -e "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s:^daemonize .*:daemonize yes:'")]),s._v(" -e "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s:^supervised .*:supervised systemd:'")]),s._v(" /usr/local/redis/etc/6379.conf\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加自定义系统服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/lib/systemd/system/redis_6379.service "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[Unit]\nDescription=Redis Server Manager\nAfter=network.target\n\n[Service]\nType=forking\nPIDFile=/var/run/redis_6379.pid\nExecStart=/usr/local/redis/bin/redis-server /usr/local/redis/etc/6379.conf\nExecReload=/bin/kill -USR2 "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MAINPID")]),s._v("\nExecStop=/bin/kill -SIGINT "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MAINPID")]),s._v("\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\nEOF")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新加载系统服务配置")]),s._v("\nsystemctl daemon-reload\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看redis服务状态")]),s._v("\nsystemctl status redis_6379\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动redis服务")]),s._v("\nsystemctl start redis_6379\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止redis服务")]),s._v("\nsystemctl stop redis_6379\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新启动redis服务")]),s._v("\nsystemctl restart redis_6379\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置redis开机自动启动")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" redis_6379\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置redis开机不自动启动")]),s._v("\nsystemctl disable redis_6379\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br")])]),a("h2",{attrs:{id:"_6-开启redis远程访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-开启redis远程访问"}},[s._v("#")]),s._v(" 6. 开启redis远程访问")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改redis配置文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i -e "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s:^bind 127.0.0.1$:bind 0.0.0.0:'")]),s._v(" /usr/local/redis/etc/6379.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"关于文中提到的redis-conf配置项说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于文中提到的redis-conf配置项说明"}},[s._v("#")]),s._v(" 关于文中提到的redis.conf配置项说明")]),s._v(" "),a("p",[a("strong",[s._v("bind：")]),s._v(" 绑定服务器网络接口地址，如本机有内网和外网两个IP，可以绑定内网IP使redis仅接受从内网IP进来的请求，默认bind 127.0.0.1（接受本地IP请求），改为bind 0.0.0.0（接受所有请求，仅测试使用）。")]),s._v(" "),a("p",[a("strong",[s._v("daemonize：")]),s._v(" 是否以守护进程方式运行，默认为 no，改为yes 以守护进程的方式运行。")]),s._v(" "),a("p",[a("strong",[s._v("supervised：")]),s._v(" 可以通过upstart和systemd等方式管理Redis守护进程 ，默认为 no，改为 systemd 通过systemd管理Redis守护进程。")]),s._v(" "),a("p",[s._v("这里仅为本地测试环境，配置较为简单，其他还有很多相关配置，请根据实际需要进行配置。")])])}),[],!1,null,null,null);n.default=e.exports}}]);